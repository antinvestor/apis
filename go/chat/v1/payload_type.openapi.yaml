openapi: 3.1.0
info:
  title: chat.v1
paths: {}
components:
  schemas:
    chat.v1.AttachmentContent:
      type: object
      properties:
        attachmentId:
          type: string
          title: attachment_id
          description: Logical identifier of the attachment
        filename:
          type: string
          title: filename
          description: Original filename (optional, user-facing)
        mimeType:
          type: string
          title: mime_type
          description: MIME type (e.g. image/png, application/pdf)
        sizeBytes:
          type:
            - integer
            - string
          title: size_bytes
          format: int64
          description: Size in bytes (for quota enforcement & UX)
        uri:
          type: string
          title: uri
          description: Content location (signed URL or opaque locator)
        previews:
          type: array
          items:
            $ref: '#/components/schemas/chat.v1.AttachmentPreview'
          title: previews
          description: Optional previews / thumbnails
        caption:
          title: caption
          description: Optional caption text
          nullable: true
          $ref: '#/components/schemas/chat.v1.TextContent'
        encrypted:
          type: boolean
          title: encrypted
          description: Indicates whether attachment is end-to-end encrypted
        checksum:
          type:
            - string
            - "null"
          title: checksum
          description: Optional content hash (e.g. sha256:base64)
          nullable: true
      title: AttachmentContent
      additionalProperties: false
    chat.v1.AttachmentPreview:
      type: object
      properties:
        mimeType:
          type: string
          title: mime_type
        width:
          type: integer
          title: width
          format: int32
        height:
          type: integer
          title: height
          format: int32
        uri:
          type: string
          title: uri
        sizeBytes:
          type:
            - integer
            - string
          title: size_bytes
          format: int64
      title: AttachmentPreview
      additionalProperties: false
    chat.v1.CallContent:
      type: object
      properties:
        callId:
          type: string
          title: call_id
        type:
          title: type
          $ref: '#/components/schemas/chat.v1.CallContent.CallType'
        action:
          title: action
          description: |-
            OFFER, ANSWER → sdp required
             ICE_CANDIDATE → ice_candidate required
             END → no payload required
          $ref: '#/components/schemas/chat.v1.CallContent.CallAction'
        sdp:
          type:
            - string
            - "null"
          title: sdp
          description: WebRTC payload (SDP or ICE candidate)
          nullable: true
        iceCandidate:
          type:
            - string
            - "null"
          title: ice_candidate
          description: Optional ICE candidate (when action = ICE_CANDIDATE)
          nullable: true
        metadata:
          title: metadata
          description: Optional metadata (bitrate, codecs, device hints)
          $ref: '#/components/schemas/google.protobuf.Struct'
      title: CallContent
      additionalProperties: false
    chat.v1.CallContent.CallAction:
      type: string
      title: CallAction
      enum:
        - CALL_ACTION_UNSPECIFIED
        - CALL_ACTION_OFFER
        - CALL_ACTION_ANSWER
        - CALL_ACTION_ICE_CANDIDATE
        - CALL_ACTION_END
    chat.v1.CallContent.CallType:
      type: string
      title: CallType
      enum:
        - CALL_TYPE_UNSPECIFIED
        - CALL_TYPE_AUDIO
        - CALL_TYPE_VIDEO
        - CALL_TYPE_SCREEN_SHARE
    chat.v1.EncryptedContent:
      type: object
      properties:
        algorithm:
          type: string
          title: algorithm
          description: |-
            Encryption scheme identifier
             Examples: "olm.v2", "megolm.v1", "x25519-aesgcm"
        ciphertext:
          type: string
          title: ciphertext
          format: byte
          description: Base64 or binary-safe encoded ciphertext
        nonce:
          type:
            - string
            - "null"
          title: nonce
          format: byte
          description: Optional per-message nonce / IV
          nullable: true
        senderKeyId:
          type:
            - string
            - "null"
          title: sender_key_id
          description: Optional sender key identifier
          nullable: true
        recipientKeyIds:
          type: array
          items:
            type: string
          title: recipient_key_ids
          description: Optional recipient key references (for fan-out)
        aad:
          type:
            - string
            - "null"
          title: aad
          format: byte
          description: Additional authenticated data (AAD)
          nullable: true
        sessionId:
          type:
            - string
            - "null"
          title: session_id
          description: Optional key agreement context identifier
          nullable: true
      title: EncryptedContent
      additionalProperties: false
    chat.v1.Payload:
      type: object
      oneOf:
        - properties:
            attachment:
              title: attachment
              description: type = ROOM_EVENT_TYPE_ATTACHMENT
              $ref: '#/components/schemas/chat.v1.AttachmentContent'
          title: attachment
          required:
            - attachment
        - properties:
            call:
              title: call
              description: type = ROOM_EVENT_TYPE_CALL
              $ref: '#/components/schemas/chat.v1.CallContent'
          title: call
          required:
            - call
        - properties:
            encrypted:
              title: encrypted
              description: type = ROOM_EVENT_TYPE_ENCRYPTED
              $ref: '#/components/schemas/chat.v1.EncryptedContent'
          title: encrypted
          required:
            - encrypted
        - properties:
            reaction:
              title: reaction
              description: type = ROOM_EVENT_TYPE_REACTION
              $ref: '#/components/schemas/chat.v1.ReactionContent'
          title: reaction
          required:
            - reaction
        - properties:
            text:
              title: text
              description: type = ROOM_EVENT_TYPE_TEXT
              $ref: '#/components/schemas/chat.v1.TextContent'
          title: text
          required:
            - text
      title: Payload
      additionalProperties: false
    chat.v1.ReactionContent:
      type: object
      properties:
        targetEventId:
          type: string
          title: target_event_id
          minLength: 3
          description: Target message being reacted to
        reaction:
          type: string
          title: reaction
          maxLength: 64
          minLength: 1
          description: "Reaction key (e.g. \U0001F44D, ❤️, :custom_emoji:)"
        add:
          type: boolean
          title: add
          description: |-
            add=true → ensure reaction exists
             add=false → ensure reaction does not exist
      title: ReactionContent
      additionalProperties: false
    chat.v1.TextAnnotation:
      type: object
      properties:
        type:
          title: type
          $ref: '#/components/schemas/chat.v1.TextAnnotation.Type'
        offset:
          type: integer
          title: offset
          format: int32
          description: UTF-16 offset & length for cross-platform compatibility
        length:
          type: integer
          title: length
          format: int32
        value:
          type: string
          title: value
          description: Target identifier (e.g., profile_id, room_id, URL)
      title: TextAnnotation
      additionalProperties: false
    chat.v1.TextAnnotation.Type:
      type: string
      title: Type
      enum:
        - TYPE_UNSPECIFIED
        - TYPE_MENTION_USER
        - TYPE_MENTION_ROOM
        - TYPE_LINK
        - TYPE_EMOJI
        - TYPE_HASHTAG
    chat.v1.TextContent:
      type: object
      properties:
        body:
          type: string
          title: body
          maxLength: 10000
          minLength: 1
          description: Required human-readable message body
        format:
          type: string
          title: format
          maxLength: 32
          minLength: 1
          description: |-
            Content format identifier (NOT MIME type)
             Examples: "plain", "markdown", "html-lite"
        annotations:
          type: array
          items:
            $ref: '#/components/schemas/chat.v1.TextAnnotation'
          title: annotations
          description: Structured annotations for clients (mentions, links, emojis)
        lang:
          type:
            - string
            - "null"
          title: lang
          description: Optional language hint (BCP-47), e.g. "en", "fr-CA"
          nullable: true
      title: TextContent
      additionalProperties: false
    google.protobuf.ListValue:
      type: object
      properties:
        values:
          type: array
          items:
            $ref: '#/components/schemas/google.protobuf.Value'
          title: values
          description: Repeated field of dynamically typed values.
      title: ListValue
      additionalProperties: false
      description: |-
        `ListValue` is a wrapper around a repeated field of values.

         The JSON representation for `ListValue` is JSON array.
    google.protobuf.NullValue:
      type: string
      title: NullValue
      enum:
        - NULL_VALUE
      description: |-
        `NullValue` is a singleton enumeration to represent the null value for the
         `Value` type union.

         The JSON representation for `NullValue` is JSON `null`.
    google.protobuf.Struct:
      type: object
      additionalProperties:
        $ref: '#/components/schemas/google.protobuf.Value'
      description: |-
        `Struct` represents a structured data value, consisting of fields
         which map to dynamically typed values. In some languages, `Struct`
         might be supported by a native representation. For example, in
         scripting languages like JS a struct is represented as an
         object. The details of that representation are described together
         with the proto support for the language.

         The JSON representation for `Struct` is JSON object.
    google.protobuf.Struct.FieldsEntry:
      type: object
      properties:
        key:
          type: string
          title: key
        value:
          title: value
          $ref: '#/components/schemas/google.protobuf.Value'
      title: FieldsEntry
      additionalProperties: false
    google.protobuf.Value:
      oneOf:
        - type: "null"
        - type: number
        - type: string
        - type: boolean
        - type: array
        - type: object
          additionalProperties: true
      description: |-
        `Value` represents a dynamically typed value which can be either
         null, a number, a string, a boolean, a recursive struct value, or a
         list of values. A producer of value is expected to set one of these
         variants. Absence of any variant indicates an error.

         The JSON representation for `Value` is JSON value.
security: []
